<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title></title>
    <script type="text/javascript">
        function d() {
            var text = getQueryVariable(
              urlParse(
                getQueryVariable(
                  urlParse(document.querySelector('#url').value).query, 'fromURI')
                ).query, 'RelayState'
              );
            document.querySelector('#urlResult').innerHTML = text;
            window.getSelection().removeAllRanges();
            setTimeout(function() {
                var copyTextarea = document.querySelector('#urlResult');
                var range = document.createRange();
                range.selectNode(copyTextarea);
                window.getSelection().addRange(range);
                try {
                    var successful = document.execCommand('copy');
                    var msg = successful ? 'successful' : 'unsuccessful';
                    console.log('Copying text command was ' + msg);
                } catch (err) {
                    console.log('Oops, unable to copy');
                }
                window.getSelection().removeAllRanges();
                document.querySelector('#url').value = '';
            }, 10)

            return text;
        }

        function urlParse(url){
          var parser = document.createElement('a');
          parser.href = url;
          parser.query = parser.search.substr(1);
          return parser;

        }

        function getQueryVariable(query, variable) {
            var query = query;
            var vars = query.split('&');
            for (var i = 0; i < vars.length; i++) {
                var pair = vars[i].split('=');
                if (decodeURIComponent(pair[0]) == variable) {
                    return decodeURIComponent(pair[1]);
                }
            }
            console.log('Query variable %s not found', variable);
        }
    </script>
    <style media="screen">
        body {
            font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
            font-size: 16px;
        }
    </style>
</head>

<body>
    <p>
        <label for="url">Ingrese la URL</label>
        <input type="text" name="url" value="" id="url" onkeyup="d()">
    </p>
    <div id="urlResult">

    </div>
</body>

</html>
